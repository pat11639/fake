<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    
    <!-- Always force latest IE rendering engine or request Chrome Frame -->
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    
    <!-- Use title if it's in the page YAML frontmatter -->
    <title>Ruby Under a Microscope - Pat Shaughnessy</title>
    
    <link href="/assets/stylesheets/base.css" media="screen" rel="stylesheet" type="text/css" />
    <link href='http://fonts.googleapis.com/css?family=Nothing+You+Could+Do' rel='stylesheet' type='text/css'>
  </head>
  
  <body class="index">
    <div id='banner'>
  <div class='content'>
    <a href='/'>
      <span class='author'>Pat Shaughnessy</span>
      <span class='about'>blogger, rubyist, aspiring author</span>
    </a>
  </div>
</div>
<div class='page'>
  <h2>Have You Ever Wondered How Ruby Works Internally?</h2>
  <p></p>
  <div style="clear: right"></div>
  <div style='float: right; margin-bottom: 0px;'>
    <div id='book-tweet'>
      <a class='top-buy-now' href='http://nostarch.com/rum'>Buy Now at NoStarch.com</a>
      <a class='twitter-share-button' data-count='horizontal' data-text='Ruby Under a Microscope' data-via='pat_shaughnessy' href='https://twitter.com/share'>Tweet</a><br/>
    </div>
    <a href="http://nostarch.com/rum"><img src='/assets/images/RUM_coverfront.png' style="padding-left: 10px; padding-right: 10px" /></a>
    <script src='//platform.twitter.com/widgets.js' type='text/javascript'></script>
  </div>
  <p>Everyone knows that Ruby is a powerful language. Its dynamic nature allows you to concisely write the code you need to actually solve a problem instead of burying yourself under mountains of boilerplate. You don't have to fight it; you just get to enjoy the ride.</p>
  <p>But how is the magic created? And can you trust it? After all, MRI is written in C - a statically typed, compiled language which is pretty much the antithesis of Ruby. What <strong>dark voodoo</strong> is breathed into C to enable Ruby's features - closures, metaprogramming, and so much more?</p>
  <h2>Find out with Science!</h2>
  <p>Ruby Under a Microscope will guide you through the internals of some of Ruby's most-used facets. Using experimentation, theory, and two truckloads of diagrams, you'll <strong>clearly see how Ruby is implemented</strong>.</p>
  <div class='diagram'>
    <img src='/assets/images/tokenize.png' />
    <div class='caption'>Here's just one of the diagrams out of the two truckloads. <br />Did you think that was a exaggeration? Well, it isn't!</div>
  </div>
  <p>Here's a science fact for you: before they understood the nature of combustion, Enlightenment chemists believed fire resulted from the release of a negative-weight particle called "phlogiston". Then Antoine-Laurent Lavoisier knocked that theory on its derri&egrave;re by discovering oxygen and proving how combustion really works.</p>
  <p>This book will offer you the same clarity. Instead of pointing at a Ruby block and yelling, "Phlogiston!", you'll be able to lucidly explain how Ruby copies variables from the stack to the heap in order to allow access to them even after a function has returned.</p>
  <p>Have no clue what that means? Well, that's exactly why you need to read this book.</p>
  <p>And good news: you don't need to know a lick of C! If you can't tell your pointers from your pointers to pointers, then have no fear. <strong>Ruby Under a Microscope is accessible to anyone</strong> with an interest in learning how Ruby works internally.</p>
  <h2>People Already Love It</h2>
  <p>Here's what people are already saying about <strong>Ruby Under a Microscope</strong>:</p>
  <blockquote>
    <div class='pic'>
      <img src='/assets/images/avatars/peter.png' />
    </div>
    <div class='content'>
      Many people have dug into the Ruby source code but few make it back out
      and tell the tale as elegantly as Pat does in Ruby Under A Microscope! I
      particularly love the diagrams - and there are lots of them - as they
      make many opaque implementation topics a lot easier to understand,
      especially when coupled with Pat's gentle narrative. This book is a
      delight for language implementation geeks and Rubyists with a penchant
      for digging into the guts of their tools.
      <footer>
        &ndash;
        <cite>
          Peter Cooper (<a href="https://twitter.com/peterc">@peterc</a>) &mdash; Editor of Ruby Inside and Ruby Weekly
        </cite>
      </footer>
    </div>
  </blockquote>
  <blockquote>
    <div class='pic'>
      <img src='/assets/images/avatars/xavier.jpg' />
    </div>
    <div class='content'>
      going to proofread a draft of @pat_shaughnessy's "Ruby Under a Microscope", man this book was missing in the Ruby landscape, awesome content
      <footer>
        &ndash;
        <cite>
          Xavier Noria (<a href="https://twitter.com/fxn">@fxn</a>) &mdash; Ruby Hero, Ruby on Rails Core Team Member
        </cite>
      </footer>
    </div>
  </blockquote>
  <blockquote>
    <div class='pic'>
      <img src='/assets/images/avatars/santiago.jpg' />
    </div>
    <div class='content'>
      Pat Shaughnessy did a tremendous job writing THE book about Ruby
      internals. Definitely a must read, you won't find information like this
      anywhere else.
      <footer>
        &ndash;
        <cite>
          Santiago Pastorino (<a href="https://twitter.com/spastorino">@spastorino</a>) &mdash; WyeWorks Co-Founder, Ruby on Rails Core Team Member
        </cite>
      </footer>
    </div>
  </blockquote>
  <blockquote>
    <div class='pic'>
      <img src='/assets/images/avatars/vlad.jpg' />
    </div>
    <div class='content'>
      I really enjoyed the book and now know have a far better understanding of both Ruby and CS - thanks. Your writing made very complex topics (at least for me) very accessible and I found the book hard to put down. Diagrams were awesome and already are popping in my head as I code. This is by far one of my top 3 favourite Ruby books written.
      <footer>
        &ndash;
        <cite>
          Vlad Ivanovic (<a href="https://twitter.com/vladiim">@vladiim</a>) &mdash; Digital Strategist @ MassMedia Sydney.
        </cite>
      </footer>
    </div>
  </blockquote>
  <blockquote>
    <div class='pic'>
      <img src='/assets/images/avatars/deryl.jpg' />
    </div>
    <div class='content'>
      While I'm not usually digging into Ruby Internals, your book was an absolute awesome read. Best $20 I've spent in ages.
      <footer>
        &ndash;
        <cite>
          David Deryl Downey (<a href="https://twitter.com/daviddwdowney">@daviddwdowney</a>) &mdash; Founder of CyberSpace Technologies Group
        </cite>
      </footer>
    </div>
  </blockquote>

  <h2>Table of Contents</h2>
  <p> 
  <table id='toc'>
    <tr>
      <td class='main'>Foreword by Aaron Patterson</td>
      <td>xv</td>
    </tr>
    <tr>
      <td class='main'>Acknowledgments</td>
      <td>xvii</td>
    </tr>
    <tr>
      <td class='main'>Introduction</td>
      <td>xix</td>
    </tr>
    <tr>
      <td class='main'>Chapter 1: Tokenization and Parsing</td>
      <td>3</td>
    </tr>
    <tr>
      <td class='main'>Chapter 2: Compilation</td>
      <td>31</td>
    </tr>
    <tr>
      <td class='main'>Chapter 3: How Ruby Executes Your Code</td>
      <td>55</td>
    </tr>
    <tr>
      <td class='main'>Chapter 4: Control Structures and Method Dispatch</td>
      <td>83</td>
    </tr>
    <tr>
      <td class='main'>Chapter 5: Objects and Classes</td>
      <td>105</td>
    </tr>
    <tr>
      <td class='main'>Chapter 6: Method Lookup and Constant Lookup</td>
      <td>133</td>
    </tr>
    <tr>
      <td class='main'>Chapter 7: The Hash Table: The Workhorse of Ruby Internals</td>
      <td>167</td>
    </tr>
    <tr>
      <td class='main'>Chapter 8: How Ruby Borrowed a Decades-Old Idea from Lisp</td>
      <td>191</td>
    </tr>
    <tr>
      <td class='main'>Chapter 9: Metaprogramming</td>
      <td>219</td>
    </tr>
    <tr>
      <td class='main'>Chapter 10: JRuby: Ruby on the JVM</td>
      <td>251</td>
    </tr>
    <tr>
      <td class='main'>Chapter 11: Rubinius: Ruby Implemented with Ruby</td>
      <td>273</td>
    </tr>
    <tr>
      <td class='main'>Chapter 12: Garbage Collection in MRI, JRuby, and Rubinius</td>
      <td>295</td>
    </tr>
    <tr>
      <td class='main'>Index</td>
      <td>327</td>
    </tr>
  </table>
  <h2>About Pat</h2>
  <div id='mugshot'>
    <img src='/assets/images/pat2.jpeg' />
  </div>
  <p>
    Pat Shaughnessy writes a blog about Ruby development here on this web site,
    <a href="https://patshaughnessy.net">patshaughnessy.net</a>. Pat's articles
    and presentations have been featured multiple times on the Ruby Weekly
    newsletter, the Ruby5 podcast and the Ruby Show.
  </p>
  <p>
    When he's not at the keyboard, Pat enjoys spending time with his wife and
    two kids. Pat is also a fluent Spanish speaker and travels frequently to
    Spain to visit his wife's family.
  </p>
  <div id='book-comments'></div>
  <div id='disqus_thread'>
    <script type='text/javascript'>
      //<![CDATA[
        var disqus_identifier = 'https://patshaughnessy.net/ruby-under-a-microscope';
        var disqus_shortname = 'patshaughnessy';
      //]]>
    </script>
    <script src='http://disqus.com/forums/patshaughnessy/embed.js' type='text/javascript'></script>
    <noscript>
      <a href='http://patshaughnessy.disqus.com/?url=ref'>View the discussion thread.</a>
    </noscript>
    <script type='text/javascript'>
      //<![CDATA[
        var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
        document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
      //]]>
    </script>
    <script type='text/javascript'>
      //<![CDATA[
        try {
        var pageTracker = _gat._getTracker("UA-5273122-4");
        pageTracker._trackPageview();
        } catch(err) {}
      //]]>
    </script>
  </div>
</div>
<div id='credits'>
  Page design and copy by <a href="http://www.flyingmachinestudios.com">Daniel Higginbotham</a>. You might like his Mac app, <a href="http://flyingmachinestudios.com/foreman">Foreman</a>
</div>

  </body>
</html>
